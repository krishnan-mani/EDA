# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
# SPDX-License-Identifier: Apache-2.0
def lambda_handler(event:, context:)
    event['Records'].each do |message|
      process_message(message)
    end
    puts "done"
end
  
def process_message(message)
    begin
      puts "Processed message #{message['body']}"
      # TODO: Do interesting work based on the new message
    rescue StandardError => err
      puts "An error occurred"
      raise err
    end
end
  